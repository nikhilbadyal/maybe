<%# locals: (account:, account_group:, mobile: false, show_subtype_label: true) %>

<%= link_to account_path(account),
          class: class_names(
            "block flex items-center gap-2 px-3 py-2 rounded-lg",
            page_active?(account_path(account)) ? "bg-container" : "hover:bg-surface-hover"
          ),
          title: account.name do %>
  <%= render "accounts/logo", account: account, size: "sm", color: account_group.color %>

  <div class="min-w-0 grow">
    <div class="flex items-center gap-2 mb-0.5">
      <%= tag.p account.name, class: class_names("text-sm text-primary font-medium truncate", "animate-pulse" => account.syncing?) %>
    </div>
    <%# Only show subtype label when explicitly requested (e.g., non-Depository groups) %>
    <% if show_subtype_label %>
      <%= tag.p account.short_subtype_label, class: "text-xs text-secondary truncate" %>
    <% end %>
  </div>

  <div class="ml-auto text-right grow h-10">
    <%= tag.p format_money(account.balance_money), class: "text-sm font-medium text-primary whitespace-nowrap" %>
    <%= turbo_frame_tag dom_id(account, :sparkline), src: sparkline_account_path(account), loading: "lazy", data: { controller: "turbo-frame-timeout", turbo_frame_timeout_timeout_value: 10000 } do %>
      <div class="flex items-center w-8 h-4 ml-auto">
        <div class="w-6 h-px bg-loader"></div>
      </div>
    <% end %>
  </div>
<% end %>


